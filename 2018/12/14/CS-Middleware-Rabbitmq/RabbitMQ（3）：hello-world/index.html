<!DOCTYPE html>
<html>
  <head><meta name="generator" content="Hexo 3.9.0">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
  <meta name="description" content="读书、健身、旅行">
  <meta name="keyword" content="haxianhe">
  
    <link rel="shortcut icon" href="/css/images/logo.png">
  
  <title>
    
      RabbitMQ（3）：hello-world | haxianhe&#39;s blog
    
  </title>
  <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <link href="//cdnjs.cloudflare.com/ajax/libs/nprogress/0.2.0/nprogress.min.css" rel="stylesheet">
  <link href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/tomorrow.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/css/style.css">
  
  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/geopattern/1.2.3/js/geopattern.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/nprogress/0.2.0/nprogress.min.js"></script>
  
    <script src="/js/qrious.js"></script>
  
  
  
  
    <!-- MathJax support START -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <!-- MathJax support END -->
  


  
  
    <script src="/js/local-search.js"></script>

<link rel="alternate" href="/atom.xml" title="haxianhe's blog" type="application/atom+xml">
</head>
<div class="wechat-share">
  <img src="/css/images/logo.png">
</div>
  <body>
    <header class="header fixed-header">
  <div class="header-container">
    <a class="home-link" href="/">
      <div class="logo"></div>
      <span>haxianhe's blog</span>
    </a>
    <ul class="right-list">
      
        <li class="list-item">
          
            <a href="/" class="item-link">主页</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/series/" class="item-link">分类</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/tags/" class="item-link">标签</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/archives/" class="item-link">归档</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/project/" class="item-link">项目</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/about/" class="item-link">关于</a>
          
        </li>
      
      
        <li class="menu-item menu-item-search right-list">
    <a role="button" class="popup-trigger">
        <i class="fa fa-search fa-fw"></i>
    </a>
</li>
      
    </ul>
    <div class="menu">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </div>
    <div class="menu-mask">
      <ul class="menu-list">
        
          <li class="menu-item">
            
              <a href="/" class="menu-link">主页</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/series/" class="menu-link">分类</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/tags/" class="menu-link">标签</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/archives/" class="menu-link">归档</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/project/" class="menu-link">项目</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/about/" class="menu-link">关于</a>
            
          </li>
        
      </ul>
    </div>
    
      <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
            <span class="search-icon">
                <i class="fa fa-search"></i>
            </span>
            <div class="search-input-container">
                <input autocomplete="off" autocapitalize="off"
                    placeholder="Please enter your keyword(s) to search." spellcheck="false"
                    type="search" class="search-input">
            </div>
            <span class="popup-btn-close">
                <i class="fa fa-times-circle"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>
    
  </div>
</header>

    <div id="article-banner">
  <h2>RabbitMQ（3）：hello-world</h2>
  <p class="post-date">2018-12-14</p>
  <div class="arrow-down">
    <a href="javascript:;"></a>
  </div>
</div>
<main class="app-body flex-box">
  <!-- Article START -->
  <article class="post-article">
    <section class="markdown-content"><h1 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h1><p>RabbitMQ是一个消息代理器: 它接受和转发消息。你可以把它当作一个邮局: 当你把你的邮件放到邮箱里的时候, 你可以肯定邮差最终会把你的邮件交给你邮件上的收件人。在这个比喻中, RabbitMQ扮演的就是这个邮箱、邮局和邮差的角色。</p>
<p>RabbitMQ和邮局之间的主要区别是，它不处理纸质邮件，而是接受，存储和转发二进制数据——消息。</p>
<p>RabbitMQ和一般的消息传递，有一些专业术语：</p>
<p>生产者（Producing）的工作就是发送消息。生产者是一个发送消息的程序：</p>
<p><img src="https://raw.githubusercontent.com/haxianhe/pic/master/image/006tNbRwgy1fy6ce13yxdj301z01fdfq.jpg" alt></p>
<p>RabbitMQ包含一个队列，这个队列起类似邮箱的作用。虽然消息经过RabbitMQ和应用程序，但是他们只可以被存储在队列中。队列只受主机内存和磁盘的限制，它本质上是一个很大的消息缓冲区。生产者可以将消息发送到队列，然后消费者可以从队列接收消息。下图是我们如何表示一个队列：</p>
<p><img src="https://raw.githubusercontent.com/haxianhe/pic/master/image/006tNbRwgy1fy6ceijxivj303m02j3yf.jpg" alt></p>
<p>消费者的工作就是接收消息。消费者是一个等待接收消息的程序。</p>
<p><img src="https://raw.githubusercontent.com/haxianhe/pic/master/image/006tNbRwgy1fy6crd1ujyj301z01fa9y.jpg" alt></p>
<p>注意：生产者，消费者和消息代理可以不再同一台主机上；一个应用程序可以既是生产者也是消费者。</p>
<h1 id="“Hello-World”"><a href="#“Hello-World”" class="headerlink" title="“Hello World”"></a>“Hello World”</h1><blockquote>
<p><strong>(using the php-amqplib Client)</strong></p>
<p>In this part of the tutorial we’ll write two programs in PHP; a producer that sends a single message, and a consumer that receives messages and prints them out. We’ll gloss over some of the detail in the <a href="https://github.com/php-amqplib/php-amqplib" target="_blank" rel="noopener">php-amqplib</a> API, concentrating on this very simple thing just to get started. It’s a “Hello World” of messaging.</p>
</blockquote>
<p>在下图中，“P”是我们的生产者，“C”是我们的消费者。中间的方框是一个缓存消息的队列。</p>
<p><img src="https://raw.githubusercontent.com/haxianhe/pic/master/image/006tNbRwgy1fy6cu0ymurj30aw01nwej.jpg" alt></p>
<p><strong>The php-amqplib client library</strong></p>
<p>RabbitMQ应用了很多协议。这个实例中包含了AMQP 0-9-1，这是一个以开源，通用为设计目的的消息协议。RabbitMQ有很多用不同语言实现的客户端。在这个实例中我们将使用php-amqplib，并且用Composer来管理依赖。</p>
<p>在你的项目中添加一个 <em>composer.json</em> 文件：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"require"</span>: &#123;</span><br><span class="line">        <span class="attr">"php-amqplib/php-amqplib"</span>: <span class="string">"&gt;=2.6.1"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如何你之前没有安装Composer，你可以使用下面的命令进行安装。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install composer</span><br></pre></td></tr></table></figure>
<p>安装好Composer之后，执行一下下面的命令来添加依赖。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">composer install</span><br></pre></td></tr></table></figure>
<p>现在，我们的php-ampqlib库已经装好了，我们可以开始写代码了。</p>
<h1 id="Sending"><a href="#Sending" class="headerlink" title="Sending"></a>Sending</h1><p><img src="https://raw.githubusercontent.com/haxianhe/pic/master/image/006tNbRwgy1fy6elwynd8j306002smx4.jpg" alt></p>
<p>我们将生产者命名为 <em>send.php</em>，将消费者命名为 <em>receive.php</em>。生产者将连接RabbitMQ，发送一条消息，然后退出。</p>
<p>在 <em>send.php</em> 中, 我们需要导入类库并使用use引入必须的类：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">require_once</span> <span class="keyword">__DIR__</span> . <span class="string">'/vendor/autoload.php'</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">PhpAmqpLib</span>\<span class="title">Connection</span>\<span class="title">AMQPStreamConnection</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">PhpAmqpLib</span>\<span class="title">Message</span>\<span class="title">AMQPMessage</span>;</span><br></pre></td></tr></table></figure>
<p>然后我们创建一个连接服务器的Connection：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$connection = <span class="keyword">new</span> AMQPStreamConnection(<span class="string">'localhost'</span>, <span class="number">5672</span>, <span class="string">'guest'</span>, <span class="string">'guest'</span>);</span><br><span class="line">$channel = $connection-&gt;channel();</span><br></pre></td></tr></table></figure>
<p>这个连接抽象了socket连接，并且替我们完成协议版本确认和授权的工作。这里我们适用localhost连接到了本地的一个消息代理。如果我们想要连接到其他机器的消息代理上，我们只需要修改一下IP地址。</p>
<p>接下来我们初始化一个信道，在rabbitmq中大部分的API操作都集中于信道这个位置。</p>
<p>发送消息前，我们必须定义一个队列，然后我们将一个消息发送到这个队列上。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$channel-&gt;queue_declare(<span class="string">'hello'</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>);</span><br><span class="line"></span><br><span class="line">$msg = <span class="keyword">new</span> AMQPMessage(<span class="string">'Hello World!'</span>);</span><br><span class="line">$channel-&gt;basic_publish($msg, <span class="string">''</span>, <span class="string">'hello'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">" [x] Sent 'Hello World!'\n"</span>;</span><br></pre></td></tr></table></figure>
<p>这里建议每次发送消息前都定义一下队列，虽然如果之前同一个名字的队列已经创建过就不会创建了，但是为了防止因为没有创建队列而出错，最好养成每次使用前创建队列的习惯。消息的内容是以字节数组的形式发送的，所以这里你可以用任何一种编码方式发送消息。</p>
<p>最后，我们需要关闭信道和服务器连接。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$channel-&gt;close();</span><br><span class="line">$connection-&gt;close();</span><br></pre></td></tr></table></figure>
<p><a href="https://github.com/haxianhe/rabbitmq-tutorials/blob/master/hello_world/send.php" target="_blank" rel="noopener">Here’s the whole send.php class.</a></p>
<h1 id="Receiving"><a href="#Receiving" class="headerlink" title="Receiving"></a>Receiving</h1><p>消息生产者只发送一条消息，而消息消费者需要不断的处理从RabbitMQ发来的消息，所以，我们需要保持消息消费者始终处于监听状态，并将收到的消息打印出来。</p>
<p><img src="https://raw.githubusercontent.com/haxianhe/pic/master/image/006tNbRwgy1fy6f042b04j306002sjrc.jpg" alt></p>
<p>The code (in <em>receive.php</em>) has almost the same include and uses as send:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">require_once</span> <span class="keyword">__DIR__</span> . <span class="string">'/vendor/autoload.php'</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">PhpAmqpLib</span>\<span class="title">Connection</span>\<span class="title">AMQPStreamConnection</span>;</span><br></pre></td></tr></table></figure>
<p>Setting up is the same as the publisher; we open a connection and a channel, and declare the queue from which we’re going to consume. Note this matches up with the queue that send publishes to.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$connection = <span class="keyword">new</span> AMQPStreamConnection(<span class="string">'localhost'</span>, <span class="number">5672</span>, <span class="string">'guest'</span>, <span class="string">'guest'</span>);</span><br><span class="line">$channel = $connection-&gt;channel();</span><br><span class="line"></span><br><span class="line">$channel-&gt;queue_declare(<span class="string">'hello'</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">" [*] Waiting for messages. To exit press CTRL+C\n"</span>;</span><br></pre></td></tr></table></figure>
<p>Note that we declare the queue here, as well. Because we might start the consumer before the publisher, we want to make sure the queue exists before we try to consume messages from it.</p>
<p>We’re about to tell the server to deliver us the messages from the queue. We will define a PHP <a href="http://www.php.net/manual/en/language.types.callable.php" target="_blank" rel="noopener">callable</a> that will receive the messages sent by the server. Keep in mind that messages are sent asynchronously from the server to the clients.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$callback = <span class="function"><span class="keyword">function</span> <span class="params">($msg)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">' [x] Received '</span>, $msg-&gt;body, <span class="string">"\n"</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">$channel-&gt;basic_consume(<span class="string">'hello'</span>, <span class="string">''</span>, <span class="keyword">false</span>, <span class="keyword">true</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, $callback);</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (count($channel-&gt;callbacks)) &#123;</span><br><span class="line">    $channel-&gt;wait();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Our code will block while our $channel has callbacks. Whenever we receive a message our $callback function will be passed the received message.</p>
<p><a href="https://github.com/haxianhe/rabbitmq-tutorials/blob/master/hello_world/receive.php" target="_blank" rel="noopener">Here’s the whole receive.php class</a></p>
<h1 id="Putting-it-all-together"><a href="#Putting-it-all-together" class="headerlink" title="Putting it all together"></a>Putting it all together</h1><p>Now we can run both scripts. In a terminal, run the consumer (receiver):</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php receive.php</span><br></pre></td></tr></table></figure>
<p>then, run the publisher (sender):</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php send.php</span><br></pre></td></tr></table></figure>
<p>The consumer will print the message it gets from the sender via RabbitMQ. The receiver will keep running, waiting for messages (Use Ctrl-C to stop it), so try running the sender from another terminal.</p>
<p><strong>Listing queues</strong></p>
<p>You may wish to see what queues RabbitMQ has and how many messages are in them. You can do it (as a privileged user) using the rabbitmqctl tool:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo rabbitmqctl list_queues</span><br></pre></td></tr></table></figure>
<p>官网原文：<a href="http://www.rabbitmq.com/tutorials/tutorial-one-php.html" target="_blank" rel="noopener">http://www.rabbitmq.com/tutorials/tutorial-one-php.html</a></p>
</section>
    <!-- Tags START -->
    
      <div class="tags">
        <span>Tags:</span>
        
  <a href="/tags#rabbitmq" >
    <span class="tag-code">rabbitmq</span>
  </a>

      </div>
    
    <!-- Tags END -->
    <!-- NAV START -->
    
  <div class="nav-container">
    <!-- reverse left and right to put prev and next in a more logic postition -->
    
      <a class="nav-left" href="/2018/12/14/CS-Middleware-Rabbitmq/RabbitMQ（1）：安装、使用教程/">
        <span class="nav-arrow">← </span>
        
          RabbitMQ（1）：安装、使用教程
        
      </a>
    
    
      <a class="nav-right" href="/2018/12/17/CS-Middleware-Rabbitmq/RabbitMQ（2）：AMQP-0-9-1-和-AMQP-模型高阶概述/">
        
          RabbitMQ（2）：AMQP 0-9-1 和 AMQP 模型高阶概述
        
        <span class="nav-arrow"> →</span>
      </a>
    
  </div>

    <!-- NAV END -->
    <!-- 打赏 START -->
    
    <!-- 打赏 END -->
    <!-- 二维码 START -->
    
      <div class="qrcode">
        <canvas id="share-qrcode"></canvas>
        <p class="notice">扫描二维码，分享此文章</p>
      </div>
    
    <!-- 二维码 END -->
    
      <!-- Utterances START -->
      <div id="utterances"></div>
      <script src="https://utteranc.es/client.js"
        repo="haxianhe/comment"
        issue-term="pathname"
        theme="github-light"
        crossorigin="anonymous"
        async></script>    
      <!-- Utterances END -->
    
  </article>
  <!-- Article END -->
  <!-- Catalog START -->
  
    <aside class="catalog-container">
  <div class="toc-main">
    <strong class="toc-title">Catalog</strong>
    
      <ol class="toc-nav"><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#介绍"><span class="toc-nav-text">介绍</span></a></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#“Hello-World”"><span class="toc-nav-text">“Hello World”</span></a></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#Sending"><span class="toc-nav-text">Sending</span></a></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#Receiving"><span class="toc-nav-text">Receiving</span></a></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#Putting-it-all-together"><span class="toc-nav-text">Putting it all together</span></a></li></ol>
    
  </div>
</aside>
  
  <!-- Catalog END -->
</main>

<script>
  (function () {
    var url = 'https://blog.haxianhe.com/2018/12/14/CS-Middleware-Rabbitmq/RabbitMQ（3）：hello-world/';
    var banner = ''
    if (banner !== '' && banner !== 'undefined' && banner !== 'null') {
      $('#article-banner').css({
        'background-image': 'url(' + banner + ')'
      })
    } else {
      $('#article-banner').geopattern(url)
    }
    $('.header').removeClass('fixed-header')

    // error image
    $(".markdown-content img").on('error', function() {
      $(this).attr('src', '/css/images/error_icon.png')
      $(this).css({
        'cursor': 'default'
      })
    })

    // zoom image
    $(".markdown-content img").on('click', function() {
      var src = $(this).attr('src')
      if (src !== '/css/images/error_icon.png') {
        var imageW = $(this).width()
        var imageH = $(this).height()

        var zoom = ($(window).width() * 0.95 / imageW).toFixed(2)
        zoom = zoom < 1 ? 1 : zoom
        zoom = zoom > 2 ? 2 : zoom
        var transY = (($(window).height() - imageH) / 2).toFixed(2)

        $('body').append('<div class="image-view-wrap"><div class="image-view-inner"><img src="'+ src +'" /></div></div>')
        $('.image-view-wrap').addClass('wrap-active')
        $('.image-view-wrap img').css({
          'width': `${imageW}`,
          'transform': `translate3d(0, ${transY}px, 0) scale3d(${zoom}, ${zoom}, 1)`
        })
        $('html').css('overflow', 'hidden')

        $('.image-view-wrap').on('click', function() {
          $(this).remove()
          $('html').attr('style', '')
        })
      }
    })
  })();
</script>


  <script>
    var qr = new QRious({
      element: document.getElementById('share-qrcode'),
      value: document.location.href
    });
  </script>






    <div class="scroll-top">
  <span class="arrow-icon"></span>
</div>
    <footer class="app-footer">
  <p class="copyright">
    Copyright &copy; 2018-2022 <a href="https://github.com/haxianhe" target="_blank">haxianhe</a>
</footer>

<script>
  function async(u, c) {
    var d = document, t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
    s.parentNode.insertBefore(o, s);
  }
</script>
<script>
  async("//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js", function(){
    FastClick.attach(document.body);
  })
</script>

<script>
  var hasLine = 'true';
  async("//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js", function(){
    $('figure pre').each(function(i, block) {
      var figure = $(this).parents('figure');
      if (hasLine === 'false') {
        figure.find('.gutter').hide();
      }
      hljs.configure({useBR: true});
      var lang = figure.attr('class').split(' ')[1] || 'code';
      var codeHtml = $(this).html();
      var codeTag = document.createElement('code');
      codeTag.className = lang;
      codeTag.innerHTML = codeHtml;
      $(this).attr('class', '').empty().html(codeTag);
      figure.attr('data-lang', lang.toUpperCase());
      hljs.highlightBlock(block);
    });
  })
</script>
<!-- Baidu Tongji -->

<script src="/js/script.js"></script>

  </body>
</html>